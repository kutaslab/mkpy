

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mkpy.codetagger module &mdash; mkpy 0.2.5.dev5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mkpy.pygarv module" href="mkpy.pygarv.html" />
    <link rel="prev" title="mkpy.mkh5 module" href="mkpy.mkh5.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> mkpy
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction (0.2.5.dev5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation (64-bit linux only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Quick%20Start.html">Quick start with <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../AS_howto.html">A. Stoermann’s online how-to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CheatSheet.html">Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UserGuide.html">User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ExamplesGallery.html">Examples Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Learning.html">Background reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary.html">Glossary</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Reference.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../Reference.html#module-index">Module Index</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="mkpy_api.html">mkh5, event tags, epochs</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mkpy.mkh5.html">mkpy.mkh5 module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">mkpy.codetagger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="mkpy.pygarv.html">mkpy.pygarv module</a></li>
<li class="toctree-l4"><a class="reference internal" href="mkpy.mkio.html">mkpy.mkio module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mkpy_api.html#mne-python-reader">MNE Python reader</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Reference.html#alphabetical-index"><span class="xref std std-ref">Alphabetical Index</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ReleaseNotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RolesCredits.html">Roles and credits</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mkpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../Reference.html">API Reference</a> &raquo;</li>
        
          <li><a href="mkpy_api.html">mkh5, event tags, epochs</a> &raquo;</li>
        
      <li>mkpy.codetagger module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api_source/mkpy.codetagger.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mkpy.codetagger">
<span id="mkpy-codetagger-module"></span><h1>mkpy.codetagger module<a class="headerlink" href="#module-mkpy.codetagger" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="mkpy.codetagger.CodeTagger">
<em class="property">class </em><code class="sig-prename descclassname">mkpy.codetagger.</code><code class="sig-name descname">CodeTagger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cmf</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mkpy/codetagger.html#CodeTagger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mkpy.codetagger.CodeTagger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Tag pattern-matched sequences of time-indexed integer with key:value metadata.</p>
<p>In the intended use case</p>
<ul class="simple">
<li><p>the integer values are event-markers recorded on an event or
timing track of a digital data acquisition system.</p></li>
<li><p>Each integer maps to a specific event or event-type, e.g., a
stimulus onset/offset, a response, a timing mark.</p></li>
<li><p>A sequence of integers corresponds to a sequence of events or
event types.</p></li>
<li><p>The metadata (tabular rows x columns) add further information
above and beyond the numeric value of the integer and may
include are mapped to tuples of mixed data types: strings,
integers, floats, suitable for decorating events and epochs of
data with useful information such experimental design factor
levels (Easy, Hard), continuous covariates (age of acquisition).</p></li>
</ul>
<p>The original use case was to find and decorate ERPSS log event
codes with experimental information.</p>
<p>The mechanism here is general, abstracting away from the source of
the integer 1-D arrays and the intended purpose of the metadata.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting with mkpy v0.2.1 codemaps allow but do not require
an <cite>Index</cite>.</p>
</div>
<p class="rubric">Notes</p>
<p>The UI for specifying a code tag map can be any of these file types</p>
<blockquote>
<div><dl>
<dt>Excel</dt><dd><p>an .xlsx file and (optional) named worksheet readable by
pandas.DataFrame.read_excel()</p>
<p>CodeTagger(‘myexpt/code_tag_table.xlsx’)
CodeTagger(‘myexpt/code_tag_table.xlsx!for_evoked’)
CodeTagger(‘myexpt/code_tag_table.xlsx!for_mixed_effects’)</p>
</dd>
<dt>Tabbed text</dt><dd><p>a rows x columns tab-delimited text file readable by
pandas.Data.read_csv(…, sep=” “).</p>
</dd>
<dt>YAML</dt><dd><p>a yaml map readable by yaml.load(), mock-tabular format
described below.</p>
</dd>
</dl>
</div></blockquote>
<ul>
<li><p>File formats</p>
<blockquote>
<div><dl>
<dt>Excel and Tabbed-text</dt><dd><ol class="arabic simple">
<li><p>the data must be tabular in n rows and m columns (i,j &gt;= 2)</p></li>
<li><p>column labels must be in the first row</p></li>
<li><p>the column labels must include ‘regexp’</p></li>
<li><p>there must be at least one tag column, there may be more</p></li>
</ol>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 32%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>regexp</p></th>
<th class="head"><p>col_label_1</p></th>
<th class="head"><p>&lt;col_label_m&gt;*</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pattern_1</p></td>
<td><p>code_tag_11</p></td>
<td><p>&lt;code_tag_1m&gt;*</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>pattern_n</p></td>
<td><p>code_tag_n1</p></td>
<td><p>&lt;datum_nm&gt;*</p></td>
</tr>
</tbody>
</table>
</dd>
<dt>YAML files</dt><dd><p>The YAML can be any combination of inline (JSON-ic) and
YAML indentation that PyYAML yaml.load can handle.</p>
<ol class="arabic simple">
<li><p>must have one YAML document with two keys: <code class="docutils literal notranslate"><span class="pre">columns</span></code> and <code class="docutils literal notranslate"><span class="pre">rows</span></code>.</p></li>
<li><p>the columns must start with <cite>regexp</cite></p></li>
<li><p>the columns may continue ad lib.</p></li>
<li><p>each row must be a YAML sequence with the same number of items as there are columns</p></li>
</ol>
</dd>
</dl>
<p>Example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="s">&#39;columns&#39;</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">[</span><span class="nv">regexp</span><span class="p p-Indicator">,</span> <span class="nv">bin</span><span class="p p-Indicator">,</span> <span class="nv">probability</span><span class="p p-Indicator">,</span> <span class="nv">frequency</span><span class="p p-Indicator">,</span> <span class="nv">source</span><span class="p p-Indicator">]</span>
<span class="s">&#39;rows&#39;</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#1)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">hi</span><span class="p p-Indicator">,</span>   <span class="nv">880</span><span class="p p-Indicator">,</span> <span class="nv">oboe</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#2)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">,</span> <span class="nv">hi</span><span class="p p-Indicator">,</span>   <span class="nv">440</span><span class="p p-Indicator">,</span> <span class="nv">oboe</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#3)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">3</span><span class="p p-Indicator">,</span> <span class="nv">lo</span><span class="p p-Indicator">,</span>   <span class="nv">880</span><span class="p p-Indicator">,</span> <span class="nv">oboe</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#4)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">4</span><span class="p p-Indicator">,</span> <span class="nv">lo</span><span class="p p-Indicator">,</span>   <span class="nv">440</span><span class="p p-Indicator">,</span> <span class="nv">oboe</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#5)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">5</span><span class="p p-Indicator">,</span> <span class="nv">hi</span><span class="p p-Indicator">,</span>   <span class="nv">880</span><span class="p p-Indicator">,</span> <span class="nv">tuba</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#6)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">6</span><span class="p p-Indicator">,</span> <span class="nv">hi</span><span class="p p-Indicator">,</span>   <span class="nv">440</span><span class="p p-Indicator">,</span> <span class="nv">tuba</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#7)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">7</span><span class="p p-Indicator">,</span> <span class="nv">lo</span><span class="p p-Indicator">,</span>   <span class="nv">880</span><span class="p p-Indicator">,</span> <span class="nv">tuba</span><span class="p p-Indicator">]</span>
  <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;(#8)&#39;</span><span class="p p-Indicator">,</span> <span class="nv">8</span><span class="p p-Indicator">,</span> <span class="nv">lo</span><span class="p p-Indicator">,</span>   <span class="nv">440</span><span class="p p-Indicator">,</span> <span class="nv">tuba</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>Row value data types</p>
<dl>
<dt>regexp<span class="classifier">regular expresion <cite>pattern* (#pattern) pattern*</cite></span></dt><dd><p>This is the code sequence search pattern.  Log codes are separated
by a single whitespace for matching. The <code class="docutils literal notranslate"><span class="pre">regexp</span></code> has one or
more time-locking pattern capture groups of which one begins
with the time-marking anchor symbol, <code class="docutils literal notranslate"><span class="pre">#</span></code>.</p>
<p>Flanking code patterns may be capture groups (…) and
non-capture groups (?:…)</p>
<p>All matched time-locking codes, the anchor code, and distance
between them are extracted from the mkpy.mkh5 datablocks and
merged with the code tags in the returned event_table for all
capture groups.</p>
</dd>
</dl>
<p>Additional columns: scalar (string, float, int, bool)</p>
<p>That’s it. All the real work is done by 1) specifying regular
expressions that match useful (sequences of) integer event codes
and 2) specifying the optional column values that label the
matched codes in useful ways, e.g., by specifying factors and
levels of experimental design, or numeric values for regression
modeling or …</p>
<p>Notes</p>
<ul class="simple">
<li><p>The values in any given column should all be the same data type:
string, integer, boolean, float. This is not enforced, violate
at your own risk.</p></li>
<li><p>Missing data are allowed as values but discouraged b.c. 1) they
are handled differently by the pandas csv reader vs. yaml and
Excel readers. 2) the resulting NaNs and None coerce np.int and
np.str dtype columns into np.object dtype and incur a
performance penalty and 3) np.object dtypes are not readily
serialized to hdf5 … h5py gags and pytables pickles them. 4)
It may lead to other unknown pathologies.</p></li>
<li><p>For yaml files, if missing values are unavoidable, coding them
with the yaml value .NAN is recommended for all cases … yes,
even string data. The yaml value null maps to None and behaves
differently in python/numpy/pandas. This is not enforced,
violate at your own risk</p></li>
<li><p>Floating point precision. Reading code tag maps from yaml text files
and directly from Excel .xlsx files introduces the same rounding
errors for floating point numbers, e.g. 0.357 -&gt;
0.35699999999999998. Reading text files introduces a <em>different</em>
rounding error, e.g.,0.35700000000000004.</p></li>
<li><p>There is no provision for &lt;t:n-m&gt; time interval constraints on
code patterns. Maybe someday.</p></li>
</ul>
<dl class="py exception">
<dt id="mkpy.codetagger.CodeTagger.BadCodePattern">
<em class="property">exception </em><code class="sig-name descname">BadCodePattern</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_patt</span></em>, <em class="sig-param"><span class="n">cause</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mkpy/codetagger.html#CodeTagger.BadCodePattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mkpy.codetagger.CodeTagger.BadCodePattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="mkpy.codetagger.CodeTagger.MissingAnchor">
<em class="property">exception </em><code class="sig-name descname">MissingAnchor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cause</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mkpy/codetagger.html#CodeTagger.MissingAnchor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mkpy.codetagger.CodeTagger.MissingAnchor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="mkpy.codetagger.CodeTagger.MultipleAnchors">
<em class="property">exception </em><code class="sig-name descname">MultipleAnchors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cause</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mkpy/codetagger.html#CodeTagger.MultipleAnchors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mkpy.codetagger.CodeTagger.MultipleAnchors" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mkpy.pygarv.html" class="btn btn-neutral float-right" title="mkpy.pygarv module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mkpy.mkh5.html" class="btn btn-neutral float-left" title="mkpy.mkh5 module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2020 Thomas P. Urbach, Andrey Portnoy, 2013 Nathaniel Smith

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>