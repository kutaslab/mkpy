
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples_gallery/mkh5mne_basics/read_raw.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_gallery_mkh5mne_basics_read_raw.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_gallery_mkh5mne_basics_read_raw.py:


Read h5 to mne.Raw
==================

.. GENERATED FROM PYTHON SOURCE LINES 7-9

Set up
-------

.. GENERATED FROM PYTHON SOURCE LINES 9-17

.. code-block:: default

    import mne
    from mkpy import mkh5
    from mkpy.io import mkh5mne

    # to be clear ...
    for pkg in [mkh5, mne]:
        print(pkg.__name__, pkg.__version__)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    mkpy.mkh5 0.2.5.dev5
    mne 0.22.0




.. GENERATED FROM PYTHON SOURCE LINES 18-24

mne.Raw without epochs
-------------------------------

Resting EEG with no mkpy codemapped events or epochs tables. It
includes data before and after scaling to :math:`\mu` V for
demonstration, the user warnings are expected.

.. GENERATED FROM PYTHON SOURCE LINES 24-35

.. code-block:: default


    eeg_h5_f = "../mkh5_data/sub000eeg.h5"
    eeg_raw = mkh5mne.read_raw_mkh5(eeg_h5_f)
    print(type(eeg_raw))

    eeg_raw.plot(
        scalings={"eeg": 5e-5, "eog": 1e-4},  # scale eog and eeg channels separately
        start=282.0,  # seconds into the recording
        n_channels=39,  # EEG + event channels
    )




.. image:: /examples_gallery/mkh5mne_basics/images/sphx_glr_read_raw_001.png
    :alt: read raw
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ../mkh5_data/sub000eeg.h5
    looking up data block paths, larger files take longer ...
    ok
    checking info, montage cals_AD_before/dblock_0
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 lle is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 lhz is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 MiPf is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LLPf is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RLPf is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LMPf is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RMPf is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LDFr is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RDFr is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LLFr is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RLFr is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LMFr is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RMFr is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LMCe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RMCe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 MiCe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 MiPa is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LDCe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RDCe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LDPa is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RDPa is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LMOc is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RMOc is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LLTe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RLTe is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 LLOc is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 RLOc is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 MiOc is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 A2 is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 HEOG is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 rle is not calibrated, scale is unknown
      warnings.warn(msg)
    /usr/share/miniconda/envs/env_3.8/lib/python3.8/site-packages/mkpy/io/mkh5mne.py:1111: UserWarning: mkh5 data /cals_AD_before/dblock_0 rhz is not calibrated, scale is unknown
      warnings.warn(msg)
    checking info, montage closed/dblock_0
    checking info, montage open/dblock_0
    Creating RawArray with float64 data, n_channels=39, n_times=28416
        Range : 0 ... 28415 =      0.000 ...   113.660 secs
    Ready.
    Creating RawArray with float64 data, n_channels=39, n_times=28416
        Range : 0 ... 28415 =      0.000 ...   113.660 secs
    Ready.
    Creating RawArray with float64 data, n_channels=39, n_times=45568
        Range : 0 ... 45567 =      0.000 ...   182.268 secs
    Ready.
    Creating RawArray with float64 data, n_channels=39, n_times=45568
        Range : 0 ... 45567 =      0.000 ...   182.268 secs
    Ready.
    EEG data marked as already having the desired reference.
    <class 'mkpy.io.mkh5mne.RawMkh5'>

    <MNEBrowseFigure size 640x480 with 4 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 36-41

mne.Raw with events and epochs
------------------------------

The events in this oddball paradigm were tagged with a codemap and used
to set epochs of different lengths.

.. GENERATED FROM PYTHON SOURCE LINES 41-50

.. code-block:: default


    p3_h5_f = "../mkh5_data/sub000p3.h5"

    # reusable plot parameters
    p3_raw_kws = dict(scalings={"eeg": 5e-5, "eog": 1e-4}, start=10.0, n_channels=39)

    p3_raw = mkh5mne.read_raw_mkh5(p3_h5_f)
    p3_raw.plot(**p3_raw_kws)




.. image:: /examples_gallery/mkh5mne_basics/images/sphx_glr_read_raw_002.png
    :alt: read raw
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ../mkh5_data/sub000p3.h5
    looking up data block paths, larger files take longer ...
    ok
    checking info, montage sub000/dblock_1
    checking info, montage sub000/dblock_2
    checking info, montage sub000/dblock_3
    checking info, montage sub000/dblock_4
    Creating RawArray with float64 data, n_channels=39, n_times=31232
        Range : 0 ... 31231 =      0.000 ...   124.924 secs
    Ready.
    sub000/dblock_0 setting mkh5 epochs table ms100 events and metadata
    sub000/dblock_0 setting mkh5 epochs table ms10000 events and metadata
    sub000/dblock_0 setting mkh5 epochs table ms1500 events and metadata
    sub000/dblock_0 setting mkh5 epochs table ms3000 events and metadata
    Creating RawArray with float64 data, n_channels=39, n_times=32768
        Range : 0 ... 32767 =      0.000 ...   131.068 secs
    Ready.
    sub000/dblock_1 setting mkh5 epochs table ms100 events and metadata
    sub000/dblock_1 setting mkh5 epochs table ms10000 events and metadata
    sub000/dblock_1 setting mkh5 epochs table ms1500 events and metadata
    sub000/dblock_1 setting mkh5 epochs table ms3000 events and metadata
    Creating RawArray with float64 data, n_channels=39, n_times=31744
        Range : 0 ... 31743 =      0.000 ...   126.972 secs
    Ready.
    sub000/dblock_2 setting mkh5 epochs table ms100 events and metadata
    sub000/dblock_2 setting mkh5 epochs table ms10000 events and metadata
    sub000/dblock_2 setting mkh5 epochs table ms1500 events and metadata
    sub000/dblock_2 setting mkh5 epochs table ms3000 events and metadata
    Creating RawArray with float64 data, n_channels=39, n_times=32512
        Range : 0 ... 32511 =      0.000 ...   130.044 secs
    Ready.
    sub000/dblock_3 setting mkh5 epochs table ms100 events and metadata
    sub000/dblock_3 setting mkh5 epochs table ms10000 events and metadata
    sub000/dblock_3 setting mkh5 epochs table ms1500 events and metadata
    sub000/dblock_3 setting mkh5 epochs table ms3000 events and metadata
    Creating RawArray with float64 data, n_channels=39, n_times=28416
        Range : 0 ... 28415 =      0.000 ...   113.660 secs
    Ready.
    sub000/dblock_4 setting mkh5 epochs table ms100 events and metadata
    sub000/dblock_4 setting mkh5 epochs table ms10000 events and metadata
    sub000/dblock_4 setting mkh5 epochs table ms1500 events and metadata
    sub000/dblock_4 setting mkh5 epochs table ms3000 events and metadata
    EEG data marked as already having the desired reference.

    <MNEBrowseFigure size 640x480 with 4 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 51-53

This mkh5mne helper method converts garv log_flags artifact events to "BAD_garv" mne.Annotations
for use with native MNE data screening.

.. GENERATED FROM PYTHON SOURCE LINES 53-57

.. code-block:: default


    garv_bads = mkh5mne.get_garv_bads(p3_raw, "ms1500", garv_interval=[-750, 750, "ms"])

    print(garv_bads, garv_bads.description)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    <Annotations | 58 segments: BAD_garv_32 (33), BAD_garv_48 (25)> ['BAD_garv_48' 'BAD_garv_48' 'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_48'
     'BAD_garv_48' 'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_48' 'BAD_garv_32'
     'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_48' 'BAD_garv_32'
     'BAD_garv_48' 'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32'
     'BAD_garv_48' 'BAD_garv_48' 'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_48'
     'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32'
     'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32'
     'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32'
     'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_48'
     'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_32' 'BAD_garv_48'
     'BAD_garv_32' 'BAD_garv_48' 'BAD_garv_32' 'BAD_garv_48' 'BAD_garv_48'
     'BAD_garv_32' 'BAD_garv_48' 'BAD_garv_48']





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  28.221 seconds)


.. _sphx_glr_download_examples_gallery_mkh5mne_basics_read_raw.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: read_raw.py <read_raw.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: read_raw.ipynb <read_raw.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
